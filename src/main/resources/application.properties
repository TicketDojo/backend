spring.application.name=${SPRING_APPLICATION_NAME:backdeepfamily}

# MySQL
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:mysql://localhost:3306/ticketdojo}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:root}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:root}

# JPA
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.show-sql=true
spring.jpa.hibernate.ddl-auto=update
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect

# JPA Lock Timeout (milliseconds)
spring.jpa.properties.javax.persistence.lock.timeout=3000

# ============================
# Lock Strategy Configuration (성능 테스트용)
# ============================
# 각 도메인별 락 전략을 선택할 수 있습니다.
# 옵션: NONE, NAMED, PESSIMISTIC, OPTIMISTIC

# 대기열 진입 락 전략 (NONE, NAMED, PESSIMISTIC)
# - NONE: 락 없음 (베이스라인)
# - NAMED: MySQL Named Lock (현재 기본값)
# - PESSIMISTIC: 비관적 락 (SELECT FOR UPDATE)
lock.strategy.queue=NONE

# 좌석 점유 락 전략 (NONE, NAMED, PESSIMISTIC, OPTIMISTIC)
# - NONE: 락 없음
# - PESSIMISTIC: 비관적 락 (현재 기본값)
# - NAMED: MySQL Named Lock
# - OPTIMISTIC: 낙관적 락 (@Version)
lock.strategy.seat=OPTIMISTIC

# 예약 상태 변경 락 전략 (NONE, PESSIMISTIC, OPTIMISTIC)
# - NONE: 락 없음
# - OPTIMISTIC: 낙관적 락 (현재 기본값)
# - PESSIMISTIC: 비관적 락
lock.strategy.reservation=OPTIMISTIC

# 레거시 호환성 (deprecated - 위의 lock.strategy.queue 사용 권장)
named.lock.enabled=true

# HikariCP - Named Lock 대기로 인한 커넥션 고갈 방지
spring.datasource.hikari.maximum-pool-size=${DB_POOL_MAX:20}
spring.datasource.hikari.minimum-idle=${DB_POOL_MIN:5}
spring.datasource.hikari.idle-timeout=${DB_POOL_IDLE_TIMEOUT:30000}
spring.datasource.hikari.connection-timeout=${DB_POOL_CONN_TIMEOUT:30000}
spring.datasource.hikari.max-lifetime=${DB_POOL_MAX_LIFETIME:1800000}

# ???? ??
spring.datasource.hikari.auto-commit=false
spring.jpa.properties.hibernate.connection.provider_disables_autocommit=true

# JWT secret
spring.jwt.secret=${SPRING_JWT_SECRET:rnehdduqdlwoduddlawlalsqordpsemrlvglvkgpclrldjfakskrlfrpgodiehldy}


# Actuator
management.endpoints.web.exposure.include=health,info,prometheus
# management.endpoint.health.show-details=when_authorized
management.endpoint.health.show-details=always
management.info.java.enabled=true
management.info.os.enabled=true
# management.server.port=${MANAGEMENT_PORT:8080 }

# Redis health check 비활성화 (Redis 미사용 단계)
management.health.redis.enabled=false